---
title: Administrar Surface Dock 2 con WMI
description: En este artículo se explica cómo usar WMI para supervisar y administrar de forma remota el firmware más reciente, el estado de la Directiva y los datos relacionados en los dispositivos de Surface Dock 2.
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 10/12/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
ms.openlocfilehash: 06933d49e99862fb19d0f6a09c9680a127b755cd
ms.sourcegitcommit: c1efb75e8524193bdc0a5f7496dc23a92ac665c8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/12/2020
ms.locfileid: "11114658"
---
# Administrar Surface Dock 2 con WMI

La compatibilidad con el instrumental de administración de Windows (WMI) proporciona un amplio conjunto de información de diagnóstico que permite a los administradores de ti supervisar y administrar de forma remota el firmware más reciente, el estado de la Directiva y los datos relacionados en los dispositivos de Surface Dock 2. Puede usar WMI con Windows PowerShell, System Center Operations Manager y otras herramientas. Para obtener más información sobre WMI, consulte [trabajar con WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true). 

Para habilitar la compatibilidad con WMI, vaya a [los drivers y el firmware de Surface Dock 2](https://www.microsoft.com/download/details.aspx?id=101317) y descargue el paquete correspondiente:

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;C1_x64.msi de versión:**<br>

- Surface Pro (5º gen y posterior)
- Surface Book (segunda generación y versiones posteriores)
- Surface Go (todas las generaciones)
- Portátil Surface (todas las generaciones)
- Portátil Surface Go

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;C1_arm64.msi de versión:** <br>

- Surface Pro X

## Uso de WMI con Surface Dock 2

1. Para enumerar todas las instancias de componente Dock:

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. Para tener acceso a las descripciones de propiedad de clase WMI, abra un símbolo del sistema y escriba comandos WMI donde **propiedad** sea una de las propiedades que aparecen en la tabla 1.

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **Ejemplo:** Para obtener acceso a la descripción de la propiedad CIM (modelo de **información común)** , escriba lo siguiente:
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### Tabla 1. Referencia de WMI de Surface Dock 2

| Propiedad         | Tipo   | Valores esperados                                                                                                                                                                                                            | Descripción                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | Cadena | Microcontrolador <br>"Concentrador USB 1" <br>"Concentrador USB 2" <br>"Concentrador de puertos de visualización" <br>"Controlador de entrega de alimentación" <br>"Códec de audio" <br>"Controlador Ethernet"                                                                         | En la siguiente propiedad se muestra el nombre específico del componente de dispositivo al que corresponden los datos de clase del modelo de información común (CIM).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Propiedad DeviceName       | Cadena | "Acoplamiento de superficie 1" <br>"Muelle de superficie 2"                                                                                                                                                                                        | La siguiente propiedad contiene el nombre del dispositivo de acoplamiento al que pertenece el componente de dispositivo específico.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | Cadena | Un número de serie de doce (12) dígitos que contiene solo valores numéricos                                                                                                                                                           | La siguiente propiedad registra el número de serie del dispositivo acoplado. Este número de serie es exactamente el mismo para cada componente a medida que pertenecen al mismo dispositivo de acoplamiento. Por referencia, este número de serie puede encontrarse físicamente en la parte inferior del Dock.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Id               | UInt16 | 0, 1, 2,..., 65535                                                                                                                                                                                                          | La siguiente propiedad es un identificador único que comienza desde cero (0) y cuenta. Esta variable se usa para numerar las instancias de WMI enumeradas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | Cadena | Intentos <br>"PendingDockReattach" <br>Fracasa                                                                                                                                                                             | La siguiente propiedad detalla el último intento de actualización de firmware de componente (UFC) del componente de dispositivo en cuestión. Los valores posibles son: **correcto, pendiente de** **reasociación del Dock** y **error.**<br><br><br>- **Success** indica que el firmware nuevo aplicado anteriormente se aplicó correctamente.<br>- Volver a **adjuntar en espera** indica que hay una nueva actualización pendiente para el componente del dispositivo y el usuario debe separar y volver a adjuntar el conector de superficie del Dock para aplicar la nueva actualización.<br>- **Error** indica que se ha producido un posible error legítimo durante el proceso de UFC o que el periférico no se inició en la versión esperada. En el caso de **error** , esto no indica que el dispositivo no funciona, sino que se produjo un error al intentar actualizar el dispositivo. En tal caso, el firmware anterior seguirá ejecutándose.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | Cadena | Habilitado <br>Habilitar                                                                                                                                                                                                     | La siguiente propiedad indica la Directiva actual del modo de administración de empresas (SEMM) de Surface para el componente de dispositivo. Los valores posibles son: **habilitado** y **deshabilitado.**<br><br><br>- **Enabled** indica que el sistema SEMM ha permitido que el dispositivo host acceda y use el componente del dispositivo.<br>- Deshabilitado indica que el sistema SEMM ha **deshabilitado** y, por lo tanto, ha evitado que el equipo host acceda y use el componente del dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | String [] | Una lista de cadenas hexadecimales, que puede oscilar entre "0x0000" y "0xFFFF"                                                                                                                                                        | La siguiente propiedad clasifica el identificador de producto (PID) del componente del dispositivo. Es posible que haya más de un PID en la lista. En el caso de un concentrador USB, por ejemplo, tanto los dispositivos de alta velocidad (SS) como de alta velocidad (HS) se agrupan en un "concentrador" singular. Por lo tanto, en esta matriz aparecerán dos (2) PID.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | booleano | Verdadero o falso                                                                                                                                                        | La siguiente propiedad describe el estado de aprovisionamiento del modo de administración de empresa de Surface (SEMM) del dispositivo Surface Dock. El estado de aprovisionamiento es exactamente el mismo para cada componente a medida que pertenecen al mismo dispositivo acoplado. Los valores posibles son: verdadero o falso. El valor True indica que el dispositivo Surface docking está actualmente administrado y, por tanto, se puede restringir la funcionalidad de puerto. Para obtener más información, consulta el campo de propiedad "PolicyState". El valor False indica que el dispositivo de acoplamiento de la superficie actualmente no está administrado y no tiene restricciones de características.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Estado           | Cadena | SÍ <br>Desconectado <br>: <br>Sin <br>"DeviceHandleInUse" <br>Habilitar <br>"NotSupportedByWmi"                                                                                                             | La siguiente propiedad describe el estado de la conexión del Dock con el equipo host. Los valores posibles son: **OK,** **unconnected,** **error,** **Missing,** **DeviceHandleInUse,**  **Disabled** y **NotSupportedByWmi.** <br>- **Aceptar** indica que el dispositivo se ha conectado correctamente a la máquina host y no hay problemas, lo cual inhibiría su funcionalidad <br>- **Desconectado** indica que el conector de superficie, que proporciona la conexión para todos los componentes del dispositivo, no está conectado al equipo host. <br>- **Error** indica un posible problema con la instancia de dispositivo y la interfaz de dispositivo tiene más de lo que probablemente se ha etiquetado con un signo de exclamación amarillo en el administrador de dispositivos: Compruebe la propiedad **StatusCode** para obtener información más detallada sobre el tipo de error que se ha producido. <br>- **Falta** indica que se esperaba que el dispositivo estuviera enumerado en el equipo host, pero por algún motivo no. La propiedad **StatusCode** contendrá el valor de 24 para indicar esta situación errónea.<br>- **DeviceHandleInUse** indica que otro proceso se está comunicando actualmente con el dispositivo, lo que prohíbe a este proveedor de instancias de instrumental de administración de Windows (WMI) las solicitudes de comunicación. Vuelva a ejecutar el comando WMI. <br> - Deshabilitado indica que la Directiva del modo de administración empresarial de Surface (SEMM) actual ha **deshabilitado** y, por lo tanto, ha impedido que el equipo host acceda y use el componente del dispositivo. Para obtener más información, consulta el campo de propiedad **PolicyState** .<br>- **NotSupportedByWmi** indica que el muelle conectado no es compatible actualmente con este proveedor WMI. Este estado aparecerá para el Dock de Surface 1, que actualmente no es compatible con este proveedor de instancias de WMI.|
| StatusCode       | UInt32 | [Código de error del administrador de dispositivos](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages) Obtenido de la clase CIM_LogicalDevice WMI (dentro de *cimwin32. mof*) | La siguiente propiedad proporciona el código de error del administrador de dispositivos para el componente acoplado dado. El valor cero (0) indica que el componente Dock está funcionando correctamente; un valor mayor que cero (0) indica un problema o un posible error con el componente Dock. Dado que el componente Dock puede enumerarse con varias interfaces de dispositivo, es posible que haya códigos de error de administrador de dispositivos adicionales. Este campo de propiedad solo muestra un código de error aunque haya varios disponibles. El administrador de dispositivos etiquetará el dispositivo con un signo de exclamación amarillo solo cuando se hayan producido determinados códigos de error.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ID         | Cadena | Una cadena hexadecimal que puede oscilar entre "0x0000" y "0xFFFF"                                                                                                                                                                        | La siguiente propiedad anota el identificador de proveedor específico (VID) del componente de dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Versión          | Cadena | Una cadena de versión, que tiene el siguiente formato: "x. y. z", donde x, y y z son valores numéricos.                                                                                                                            | La siguiente propiedad especifica la versión actual del firmware, que se está ejecutando actualmente en el componente de dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## Obtén más información

- [Proteger puertos de Surface Dock 2 con SEMM](secure-surface-dock-ports-semm.md)
- [Novedades de Surface Dock 2](surface-dock-whats-new.md)
- [Códigos de error del administrador de dispositivos](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages)
- [Trabajar con WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)
